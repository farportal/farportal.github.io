(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pledgeMining"],{"012d":function(t,e,n){"use strict";n("07e6")},"07e6":function(t,e,n){},"110a":function(t,e,n){},"153b":function(t,e,n){},"24d5":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"pledgeMining"},[s("contentBg",{ref:"contentBg"}),s("contentTitle",[s("div",{staticClass:"text"},[s("span",[t._v("选择您希望的方式，质押USDT/OKT")]),s("span",[t._v("或为FAR-USDT提供流动性赚取FAR")])])]),t.$isMobile()?t._e():s("redGreenBut",{nativeOn:{click:function(e){return t.$router.push("/pledgeDetail")}}},[t._v("质押挖矿收益详情")]),s("div",{staticClass:"pledgeMiningContent"},[s("div",{staticClass:"pledgeMiningSelect"},[s("div",{class:{active:0==t.active},on:{click:function(e){t.active=0,t.$refs.contentBg.getOffsetDate()}}},[s("span",[t._v("单币质押挖矿")]),s("div")]),s("div",{class:{active:1==t.active},on:{click:function(e){t.active=1,t.$refs.contentBg.getOffsetDate()}}},[s("span",[t._v("流动性质押挖矿")]),s("div")]),t.$isMobile()?s("img",{attrs:{src:n("a1c4")},on:{click:function(e){return t.$router.push("/pledgeDetail")}}}):t._e()]),s("div",{directives:[{name:"show",rawName:"v-show",value:0==t.active,expression:"active == 0"}],staticClass:"singleCurrency"},t._l(t.singleCurrency,(function(e,i){return s("div",{key:i,class:{green:0===i,blue:1===i}},[s("div",[s("div",[s("img",{attrs:{src:n("9e01")("./"+(i?"okt":"usdt")+".png")}}),s("span",[t._v(t._s(e.title))])]),s("span",[t._v("获取FAR挖矿奖励")])]),s("div",[s("div",[s("div",[s("span",[t._v(t._s(e.apys)+" %")]),s("span",[t._v("APY")])]),s("div",[s("span",[t._v(t._s(e.tvls)+" $")]),s("span",[t._v("TVL")])]),s("div",[s("span",[t._v(t._s(e.amounts)+" "+t._s(e.type))]),s("span",[t._v("我的质押")])])]),s("redGreenBut",{nativeOn:{click:function(n){return t.$router.push({path:"/pledgeMiningChild",query:{type:e.type}})}}},[t._v("挖矿")])],1)])})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.active,expression:"active == 1"}],staticClass:"fluidity"},[t.list.length?s("div",{staticClass:"green"},[t._m(0),s("div",[s("div",[s("div",[s("span",[t._v(t._s(t.list[2].apys)+" %")]),s("span",[t._v("APY")])]),s("div",[s("span",[t._v(t._s(t.list[2].tvls)+" $")]),s("span",[t._v("TVL")])]),s("div",[s("span",[t._v(t._s(t.list[2].amounts)+" "+t._s(t.list[2].type))]),s("span",[t._v("我的质押")])])]),s("redGreenBut",{nativeOn:{click:function(e){return t.$router.push({path:"/pledgeMiningChild",query:{type:t.list[2].type}})}}},[t._v("挖矿")])],1)]):t._e()])])],1)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",[s("div",[s("img",{attrs:{src:n("f6f3")}}),s("img",{attrs:{src:n("0f62")}})]),s("span",[t._v("提供FAR-USDT流动性")])]),s("span",[t._v("获取FAR挖矿奖励")])])}],a=(n("4de4"),n("4160"),n("159b"),n("96cf"),n("1da1")),o={data:function(){return{active:0,list:[]}},computed:{singleCurrency:function(){return this.list.filter((function(t){return t.index<2}))}},methods:{init:function(){var t=this;this.$contracts.PledgeMine.methods.getMyInfos().call({from:this.$address},function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(n,s){var i,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(s),t.list=[],i=["质押 USDT","质押 OKT","提供FAR-USDT流动性"],a=["USDT","OKT","LP"],e.next=6,t.$currentTime().then();case 6:e.sent,o=["ether","ether","ether"],s.apys.forEach((function(e,n){t.list.push({index:n,title:i[n],type:a[n],apys:s.apys[n],amounts:parseInt(s.amounts[n].fromWei(o[n])).toNum(),tvls:s.tvls[n]})})),t.$nextTick((function(){t.$refs.contentBg.width=document.querySelector(".pledgeMining").offsetWidth,t.$refs.contentBg.height=document.querySelector(".pledgeMining").offsetHeight,setTimeout((function(){t.$refs.contentBg.height=document.querySelector(".pledgeMining").offsetHeight}),200)}));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}},mounted:function(){this.$contracts&&this.init()}},r=o,c=r,l=(n("012d"),n("2877")),d=Object(l["a"])(c,s,i,!1,null,"60f921a3",null);e["default"]=d.exports},"487b":function(t,e,n){"use strict";n("e4eb")},"4f93":function(t,e,n){"use strict";n("110a")},5035:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pledgeMiningChild"},[s("contentBg",{ref:"contentBg"}),s("contentTitle",[s("div",{staticClass:"text"},[s("span",[t._v(t._s("存入"+t.type+"，赚取FAR"))])])]),s("div",{staticClass:"pledgeMiningChildContent"},[s("div",[s("img",{attrs:{src:n("f6f3")}}),s("div",{staticClass:"text"},[s("span",[t._v(t._s(t.earnings)+" FAR")]),s("span",[t._v("已赚取FAR")])]),s("redGreenBut",{nativeOn:{click:function(e){t.extract=!0}}},[t._v("提取")])],1),s("div",["LP"==t.type?s("div",{staticClass:"lp"},[s("img",{attrs:{src:n("f6f3")}}),s("img",{attrs:{src:n("0f62")}})]):s("div",{staticClass:"img"},[s("img",{attrs:{src:n("9e01")("./"+t.type.toLowerCase()+".png")}})]),s("div",{staticClass:"text"},[s("span",[t._v(t._s("LP"==t.type?"FAR-USDT-LP":"FAR-"+t.type))]),s("span",[t._v("获得FAR挖矿奖励")])]),s("div",{staticClass:"but"},[s("redGreenBut",{nativeOn:{click:function(e){t.show=!0}}},[t._v("质押")]),s("redGreenBut",{nativeOn:{click:function(e){t.release=!0}}},[t._v("解押")])],1)])]),s("van-overlay",{attrs:{show:t.show},on:{click:function(e){t.show=!1,t.depositAmount=""}}},[s("div",{staticClass:"deposit",on:{click:function(t){t.stopPropagation()}}},[s("div",[s("div",[s("div",{staticClass:"title"},[t._v("存入"+t._s(t.type)+"赚取FAR")]),s("div",{staticClass:"input"},[s("span",[t._v("存入"+t._s(t.type))]),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.depositAmount,expression:"depositAmount"}],attrs:{type:"number",placeholder:"存币数量"},domProps:{value:t.depositAmount},on:{input:function(e){e.target.composing||(t.depositAmount=e.target.value)}}}),s("div",[s("span",[t._v(t._s(t.type))]),s("div"),s("span",{on:{click:function(e){t.depositAmount=t.walletBalance.fromNum()}}},[t._v("最大")])])])]),s("span",[t._v("钱包可用 "+t._s(t.walletBalance)+" "+t._s(t.type))]),s("p",[t._v(" 请确保钱包中有足够的"+t._s(t.type)+"，以确保链上交易完成！ ")])]),s("div",{staticClass:"but"},["OKT"!=t.type?s("redGreenBut",{nativeOn:{click:function(e){return t.authorize(e)}}},[t._v("授权")]):t._e(),s("redGreenBut",{nativeOn:{click:function(e){return t.deposit(e)}}},[t._v("确认")])],1)])])]),s("van-overlay",{attrs:{show:t.release},on:{click:function(e){t.release=!1,t.releaseAmount=""}}},[s("div",{staticClass:"release",on:{click:function(t){t.stopPropagation()}}},[s("div",[s("div",[s("p",[t._v("您当前于"+t._s(t.type)+"质押挖矿已质押的"+t._s(t.type)+"为：")]),s("div",{staticClass:"pledgeBalance"},[s("span",[t._v(t._s(t.pledgeBalance))]),s("span",[t._v(t._s(t.type))])]),s("div",{staticClass:"input"},[s("span",[t._v("解押"+t._s(t.type))]),s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.releaseAmount,expression:"releaseAmount"}],attrs:{type:"number",placeholder:"解押数量"},domProps:{value:t.releaseAmount},on:{input:function(e){e.target.composing||(t.releaseAmount=e.target.value)}}}),s("div",[s("span",[t._v(t._s(t.type))]),s("div"),s("span",{on:{click:function(e){t.releaseAmount=t.pledgeBalance.fromNum()}}},[t._v("最大")])])])]),s("span",[t._v("最大可解押 "+t._s(t.pledgeBalance)+" "+t._s(t.type))])]),s("div",[s("redGreenBut",{nativeOn:{click:function(e){return t.doUnPledge(e)}}},[t._v("解除质押")]),s("p",[t._v(" 注：解除质押即表示您退出您所选份额的质押挖矿，不再计算质押挖矿收益 ")])],1)])])]),s("van-overlay",{attrs:{show:t.extract},on:{click:function(e){t.extract=!1}}},[s("div",{staticClass:"extract",on:{click:function(t){t.stopPropagation()}}},[s("div",[s("div",[s("p",[t._v("您当前已赚取的FAR：")]),s("div",{staticClass:"pledgeBalance"},[s("span",[t._v(t._s(t.earnings))]),s("span",[t._v("FAR")])])]),s("div",t._l(t.list,(function(e,n){return s("div",{key:n},[s("div",[s("span",[t._v(t._s(e.acquire)+" FAR")]),s("span",[t._v("获得")])]),s("div",[s("span",[t._v(t._s(e.punish)+" FAR")]),s("span",[t._v("挖矿消耗")])]),s("redGreenBut",{nativeOn:{click:function(e){return t.doFreeze(n)}}},[t._v(t._s(Number(e.lockDays)?"锁定"+e.lockDays+"日":"立即领取"))])],1)})),0)])])])],1)},i=[],a=(n("4160"),n("a9e3"),n("b680"),n("d3b7"),n("25f0"),n("3ca3"),n("159b"),n("ddb0"),n("3835")),o=n("5530"),r={data:function(){return{show:!1,release:!1,extract:!1,type:this.$route.query.type,depositAmount:"",releaseAmount:"",pledgeBalance:0,earnings:0,list:[],farAuthorize:0}},computed:Object(o["a"])(Object(o["a"])({},Vuex.mapState(["balance"])),{},{walletBalance:function(){return"USDT"===this.type?this.balance.usdt:"OKT"===this.type?this.balance.eth:this.balance.lp},typeId:function(){return"USDT"===this.type?0:"OKT"===this.type?1:2},decimal:function(){return"ether"}}),mounted:function(){this.$contracts&&this.init()},methods:{init:function(){var t=this;this.show=!1,this.release=!1,this.extract=!1,this.depositAmount="",this.releaseAmount="",Promise.all([this.$contracts.PledgeMine.methods.getMyInfos().call({from:this.$address}),this.$contracts.PledgeMine.methods.freezeable(this.typeId).call({from:this.$address})]).then((function(e){var n=Object(a["a"])(e,2),s=n[0],i=n[1];console.log(i),t.pledgeBalance=parseInt(s.amounts[t.typeId].fromWei(t.decimal)).toNum(),t.earnings=i.fromWei().toFixed(6).toNum(),t.$contracts.PledgeMine.methods.getClaimConditions().call({from:t.$address},(function(e,n){t.list=[];var s=t.earnings.fromNum().toWei();n.lockDays.forEach((function(e,i){t.list.push({lockDays:n.lockDays[i]/86400,punish:t.BN(s).mul(t.BN(n.punishRates[i])).div(t.BN("1".toWei("Mwei"))).toString().fromWei().toFixed(6).toNum(),acquire:t.BN(s).mul(t.BN(n.acquireRates[i])).div(t.BN("1".toWei("Mwei"))).toString().fromWei().toFixed(6).toNum()})}))}))}));var e="USDT"===this.type?"PsdToken":"FarUsdtLpToken";0!==this.typeId&&2!==this.typeId||this.$contracts[e].methods.allowance(this.$address,this.$contracts.PledgeMine._address).call({from:this.$address},(function(e,n){t.farAuthorize=n.fromWei()}))},doFreeze:function(t){var e=this;if(!Number(this.earnings.fromNum()))return this.$toast.fail("质押数量为0");this.$contracts.PledgeMine.methods.doFreeze(this.typeId,t).send({from:this.$address}).on("transactionHash",(function(t){e.$loading()})).on("receipt",(function(t){e.$loading(),e.$nextTick((function(){e.$toast.success("领取成功"),e.init()}))})).on("error",console.error)},doUnPledge:function(){var t=this,e=Number(this.releaseAmount),n=Number(this.pledgeBalance.fromNum());if(!e)return this.$toast.fail("请输入存币数量");if(e>n)return this.$toast.fail("质押数量不足");var s={from:this.$address};this.$contracts.PledgeMine.methods.doUnPledge(this.typeId,this.releaseAmount.toWei(this.decimal)).send(s).on("transactionHash",(function(e){t.$loading()})).on("receipt",(function(e){t.$loading(),t.$nextTick((function(){t.$toast.success("解押成功"),t.init()}))})).on("error",console.error)},deposit:function(){var t=Number(this.depositAmount),e=Number(this.walletBalance.fromNum()),n=Number(this.farAuthorize);return t?t>e?this.$toast.fail("余额不足"):t>n&&1!=this.typeId?this.$toast.fail("授权额度不足"):void this.doPledge(this.typeId):this.$toast.fail("请输入存币数量")},doPledge:function(t){var e=this;this.$contracts.PledgeMine.methods.doPledge(t,this.depositAmount.toWei()).send({from:this.$address,value:1===this.typeId?this.depositAmount.toWei():0}).on("transactionHash",(function(t){e.$loading()})).on("receipt",(function(t){e.$loading(),e.$nextTick((function(){e.$toast.success("质押成功"),e.init()}))})).on("error",console.error)},authorize:function(){var t=this,e="1000000000".toWei(),n="USDT"===this.type?"PsdToken":"FarUsdtLpToken";this.$contracts[n].methods.approve(this.$contracts.PledgeMine._address,e).send({from:this.$address}).on("transactionHash",(function(e){t.$loading()})).on("receipt",(function(e){t.$loading(),t.$nextTick((function(){t.$toast.success("授权成功"),t.farAuthorize=1e9}))})).on("error",console.error)}}},c=r,l=c,d=(n("487b"),n("4f93"),n("2877")),u=Object(d["a"])(l,s,i,!1,null,"f775a034",null);e["default"]=u.exports},a029:function(t,e,n){"use strict";n("153b")},e4eb:function(t,e,n){},ff60:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"pledgeDetail"},[n("contentBg",{ref:"contentBg"}),n("contentTitle",[n("div",{staticClass:"text"},[n("span",[t._v("我的质押收益")])])]),n("div",{staticClass:"pledgeDeailContent"},[n("div",{staticClass:"incomeBox"},[n("div",{staticClass:"incomeNum"},[n("span",[t._v(t._s(t.totalAward))]),n("span",[t._v("可领取收益")])]),n("div",{staticClass:"gray"},[n("span",[t._v("总质押")]),n("span",[t._v(t._s(t.totalFreeze)+" FAR")])]),n("span",[t._v("质押详情")]),n("div",{staticClass:"gray"},[n("span",[t._v("来自USDT领取")]),n("span",[t._v(t._s(t.usdt)+" FAR")])]),n("div",{staticClass:"gray"},[n("span",[t._v("来自OKT领取")]),n("span",[t._v(t._s(t.okt)+" FAR")])]),n("div",{staticClass:"gray"},[n("span",[t._v("来自LP领取")]),n("span",[t._v(t._s(t.lp)+" FAR")])]),n("redGreenBut",{nativeOn:{click:function(e){return t.doDraw(e)}}},[t._v("领取")])],1)])],1)},i=[],a=(n("a9e3"),n("b680"),{data:function(){return{totalFreeze:0,totalAward:0,usdt:0,okt:0,lp:0}},methods:{init:function(){var t=this;this.$contracts.PledgeMine.methods.getAwardInfo().call({from:this.$address},(function(e,n){console.log(n),t.totalFreeze=n.totalFreeze.fromWei().toFixed(2).toNum(),t.totalAward=n.totalAward.fromWei().toFixed(2).toNum(),t.usdt=n.awards[0].fromWei().toFixed(2).toNum(),t.okt=n.awards[1].fromWei().toFixed(2).toNum(),t.lp=n.awards[2].fromWei().toFixed(2).toNum()}))},doDraw:function(){var t=this;if(!Number(this.totalAward.fromNum()))return this.$toast.fail("暂无可领取收益");this.$contracts.PledgeMine.methods.doDraw().send({from:this.$address}).on("transactionHash",(function(e){t.$loading()})).on("receipt",(function(e){t.$loading(),t.$nextTick((function(){t.$toast.success("领取成功"),t.init()}))})).on("error",console.error)}},mounted:function(){this.$contracts&&this.init()}}),o=a,r=o,c=(n("a029"),n("2877")),l=Object(c["a"])(r,s,i,!1,null,"1828e4b9",null);e["default"]=l.exports}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["lockWarehouseMining"],{"2aac":function(t,n,e){"use strict";e.r(n);var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"lockIncome"},[e("div",{staticClass:"content"},[t._m(0),t._m(1),e("redGreenBut",{nativeOn:{click:function(n){return t.income(n)}}},[t._v("锁仓收益")])],1)])},s=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"allIncome"},[e("span",[t._v("500.00")]),e("span",[t._v("锁仓收益/FAR")])])},function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"incomeList"},[e("div",[e("span",[t._v("30日锁仓收益")]),e("span",[t._v("100.00 FAR")])]),e("div",[e("span",[t._v("90日锁仓收益")]),e("span",[t._v("100.00 FAR")])]),e("div",[e("span",[t._v("360日锁仓收益")]),e("span",[t._v("100.00 FAR")])])])}],o={methods:{income:function(){}}},a=o,c=a,r=(e("8e8e"),e("2877")),u=Object(r["a"])(c,i,s,!1,null,"79d0ea06",null);n["default"]=u.exports},5800:function(t,n,e){"use strict";e.r(n);var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return"/myLock"==t.$route.path?e("div",{staticClass:"myLock"},[e("div",{staticClass:"container"},[t._l(t.list,(function(n,i){return e("div",{key:i,staticClass:"box"},[e("div",{staticClass:"day"},[t._v(t._s(n.title))]),t.$isMobile()?e("div",{staticClass:"divider"}):t._e(),e("div",[e("div",[e("span",[t._v("锁仓参与数量")]),e("div",[t._v(t._s(n.lockAmounts)+" FAR")])]),e("div",[e("span",[t._v("已获得锁仓挖矿收益")]),e("div",[t._v(t._s(n.drawedEarnings)+" FAR")])]),e("div",[e("span",[t._v("锁仓挖矿到期时间")]),e("div",[t._v(t._s(n.times))])]),e("div",[e("span",[t._v("可领取收益")]),e("div",[t._v(t._s(n.claimables)+" FAR")])]),e("div",{staticClass:"butBox"},[e("redGreenBut",{class:{visibilityHide:!n.extendible},nativeOn:{click:function(e){return t.doAddLockOnePeriod(i,n.extendible)}}},[t._v("复投")]),e("redGreenBut",{class:{visibilityHide:!Number(n.unLockables.fromNum())},nativeOn:{click:function(e){t.doUnLock(i,Number(n.unLockables.fromNum()))}}},[t._v("解押")])],1)])])})),e("redGreenBut",{nativeOn:{click:function(n){return t.doDraw(n)}}},[t._v("领取收益")])],2)]):t._e()},s=[],o=(e("4160"),e("a9e3"),e("b680"),e("159b"),{data:function(){return{list:[],totalAward:0}},methods:{init:function(){var t=this;this.$contracts.LockMine.methods.getMyInfoDetail().call({from:this.$address},(function(n,e){console.log(e),t.list=[];var i=["30日","90日","360日"];e.times.forEach((function(n,s){t.list.push({title:i[s],lockAmounts:e.lockAmounts[s].fromWei().toFixed(2).toNum(),drawedEarnings:e.drawedEarnings[s].fromWei().toFixed(2).toNum(),claimables:parseInt(e.claimables[s].fromWei()).toNum(),unLockables:parseInt(e.unLockables[s].fromWei()).toNum(),times:Number(n)?t.$toTime(n,"h:mm m/d y"):"暂无",extendible:e.extendible[s]})})),t.$nextTick((function(){t.$emit("updateContentBg",!0)}))})),this.$contracts.LockMine.methods.getAwardInfo().call({from:this.$address},(function(n,e){t.totalAward=e.totalAward.fromWei()}))},doUnLock:function(t,n){var e=this;if(!n)return this.$toast.fail("暂不可解押");this.$contracts.LockMine.methods.doUnLock(t).send({from:this.$address}).on("transactionHash",(function(t){e.$loading()})).on("receipt",(function(t){e.$loading(),e.$nextTick((function(){e.$toast.success("解押成功"),e.init()}))})).on("error",console.error)},doDraw:function(){var t=this;if(!Number(this.totalAward))return this.$toast.fail("暂无收益");this.$contracts.LockMine.methods.doDraw().send({from:this.$address}).on("transactionHash",(function(n){t.$loading()})).on("receipt",(function(n){t.$loading(),t.$nextTick((function(){t.$toast.success("领取成功"),t.init()}))})).on("error",console.error)},doAddLockOnePeriod:function(t,n){var e=this;if(!n)return this.$toast.fail("暂不可复投");this.$contracts.LockMine.methods.doAddLockOnePeriod(t).send({from:this.$address}).on("transactionHash",(function(t){e.$loading()})).on("receipt",(function(t){e.$loading(),e.$nextTick((function(){e.$toast.success("复投成功"),e.init()}))})).on("error",console.error)}},mounted:function(){this.$contracts&&this.init()}}),a=o,c=a,r=(e("cc46"),e("2877")),u=Object(r["a"])(c,i,s,!1,null,"7a39ee7c",null);n["default"]=u.exports},"5de2":function(t,n,e){"use strict";e.r(n);var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("section",{staticClass:"lockWarehouseMining"},[e("contentBg",{ref:"contentBg",staticClass:"contentBg"}),e("contentTitle",[e("div",{staticClass:"text"},[e("span",[t._v("锁仓FAR，即可获得稳定收益")]),e("span",[t._v("定期理财，锁定增长")])])]),"/lockWarehouseMining"==t.$route.path?e("div",{staticClass:"butBox"},[e("redGreenBut",{nativeOn:{click:function(n){return t.pushUrl("/myLock")}}},[t._v("我的锁仓")])],1):t._e(),"/lockWarehouseMining"==t.$route.path?e("div",{staticClass:"lockWarehouseMiningContent"},t._l(t.list,(function(n,i){return e("div",{key:i,staticClass:"list"},[e("div",{staticClass:"title"},[t._v(t._s(n.title))]),e("ul",[e("li",[e("span",[t._v("APY")]),e("span",[t._v(t._s(n.apys)+" %")])]),t._m(0,!0)]),e("ul",[e("li",[e("span",[t._v("当前锁仓总量")]),e("span",[t._v(t._s(n.lockTotalAmounts)+" FAR")])]),e("li",[e("span",[t._v("剩余锁仓时间")]),e("span",[t._v(t._s(n.remainingTime)+" 小时")])]),e("li",[e("span",[t._v("我的锁仓")]),e("span",[t._v(t._s(n.lockAmounts)+" FAR")])]),e("li",[e("span",[t._v("我的收益")]),e("span",[t._v(t._s(n.earnings)+" FAR")])])]),e("p",[t._v(" 备注：一旦参加锁仓，需等到锁仓结束，才可以取回FAR，中途不能取回FAR。 ")]),e("redGreenBut",{nativeOn:{click:function(e){return t.butClick(i,n.lockables)}}},[t._v(t._s(n.lockables&&Number(n.lockAmounts.fromNum())?"继续参与":"参与锁仓"))])],1)})),0):t._e(),e("router-view",{on:{updateContentBg:t.updateContentBg}}),e("van-overlay",{attrs:{show:t.show},on:{click:function(n){t.show=!t.show}}},[e("div",{staticClass:"makeMoney",on:{click:function(t){t.stopPropagation()}}},[e("div",[e("div",[e("div",{staticClass:"title"},[t._v("锁仓赚取FAR")]),e("div",{staticClass:"input"},[e("span",[t._v("锁仓FAR")]),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],attrs:{type:"text",placeholder:"存币数量"},domProps:{value:t.amount},on:{input:function(n){n.target.composing||(t.amount=n.target.value)}}}),e("div",[e("span",[t._v("FAR")]),e("div"),e("span",{on:{click:function(n){t.amount=parseInt(t.balance.far.fromNum())}}},[t._v("最大")])])])]),e("span",[t._v("钱包可用 "+t._s(t.balance.far)+" FAR")]),e("p",[t._v("请确保钱包中有足够的FAR，以确保OKExChain链上交易完成！")])]),e("div",{staticClass:"but"},[e("redGreenBut",{nativeOn:{click:function(n){return t.authorize(n)}}},[t._v("授权")]),e("redGreenBut",{nativeOn:{click:function(n){return t.doLock(n)}}},[t._v("确认")])],1)])])])],1)},s=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("li",[e("span",[t._v("奖励总量")]),e("span",[t._v("年化收益")])])}],o=(e("4160"),e("a9e3"),e("b680"),e("d3b7"),e("25f0"),e("159b"),e("96cf"),e("1da1")),a=e("5530"),c={data:function(){return{show:!1,active:0,amount:"",farAuthorize:0,list:[],isRegister:""}},watch:{show:function(){this.amount=""}},computed:Object(a["a"])({},Vuex.mapState(["balance"])),methods:{init:function(){var t=this;this.show=!1,this.$contracts.Relation.methods.recommendInfo().call({from:this.$address},(function(n,e){var i=t.$web3.utils.hexToString(e.shotCode);t.isRegister=!!i.length})),this.$contracts.LockMine.methods.getMyInfos().call({from:this.$address},function(){var n=Object(o["a"])(regeneratorRuntime.mark((function n(e,i){var s,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=2;break}return n.abrupt("return");case 2:return console.log(i),t.list=[],s=["30日锁仓计划","90日锁仓计划","360日锁仓计划"],n.next=7,t.$currentTime().then();case 7:o=n.sent,i.apys.forEach((function(n,e){t.list.push({title:s[e],apys:i.apys[e],earnings:i.earnings[e].fromWei().toFixed(6).toNum(),lockAmounts:parseInt(i.lockAmounts[e].fromWei()).toNum(),lockTotalAmounts:parseInt(i.lockTotalAmounts[e].fromWei()).toNum(),times:i.times[e],lockables:i.lockables[e]}),t.list[e].remainingTime=parseInt((t.list[e].times-o)/60/60)})),t.$nextTick((function(){t.$refs.contentBg.width=document.querySelector(".lockWarehouseMining").offsetWidth,t.$refs.contentBg.height=document.querySelector(".lockWarehouseMining").offsetHeight}));case 10:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()),this.$contracts.FarToken.methods.allowance(this.$address,this.$contracts.LockMine._address).call({from:this.$address},(function(n,e){t.farAuthorize=e.fromWei()}))},butClick:function(t,n){if(!n)return this.$toast.fail("锁仓时间截止");this.show=!0,this.active=t},doLock:function(){var t=this,n=Number(this.amount),e=Number(this.balance.far.fromNum()),i=Number(this.farAuthorize);return n?n>e?this.$toast.fail("余额不足"):this.isRegister?n>i?this.$toast.fail("授权额度不足"):void this.$contracts.LockMine.methods.doLock(this.active,this.amount.toString().toWei()).send({from:this.$address}).on("transactionHash",(function(n){t.$loading()})).on("receipt",(function(n){t.$loading(),t.$nextTick((function(){t.$toast.success("锁仓成功"),t.init()}))})).on("error",console.error):this.$toast.fail("请先绑定推荐人"):this.$toast.fail("请输入存币数量")},authorize:function(){var t=this,n="1000000000".toWei();this.$contracts.FarToken.methods.approve(this.$contracts.LockMine._address,n).send({from:this.$address}).on("transactionHash",(function(n){t.$loading()})).on("receipt",(function(e){t.$loading(),t.$nextTick((function(){t.farAuthorize=n,t.$toast.success("授权成功")}))})).on("error",console.error)},pushUrl:function(t){this.$router.push(t)},updateContentBg:function(){var t=this;this.$nextTick((function(){t.$refs.contentBg.width=document.querySelector(".lockWarehouseMining").offsetWidth,t.$refs.contentBg.height=document.querySelector(".lockWarehouseMining").offsetHeight}))}},mounted:function(){this.$contracts&&this.init()}},r=c,u=r,l=(e("7f95"),e("6ae2"),e("2877")),d=Object(l["a"])(u,i,s,!1,null,"313edab3",null);n["default"]=d.exports},"6ae2":function(t,n,e){"use strict";e("eff0")},"7f95":function(t,n,e){"use strict";e("c9bc")},"8e8e":function(t,n,e){"use strict";e("c697")},c697:function(t,n,e){},c9bc:function(t,n,e){},cc46:function(t,n,e){"use strict";e("dba1")},dba1:function(t,n,e){},eff0:function(t,n,e){}}]);